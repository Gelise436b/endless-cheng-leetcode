
# ğŸ“ å•é¢˜ç¬”è®°ï¼š[3298] ç»Ÿè®¡é‡æ’ååˆæ³•çš„å­ä¸²æ•°ç›® II

### 1. é¢˜ç›®ç¿»è¯‘ï¼ˆå»é»‘è¯ï¼‰

* **åŸæ–‡**ï¼šâ€œx é‡æ–°æ’åˆ—åï¼Œword2 æ˜¯é‡æ’å­—ç¬¦ä¸²çš„å‰ç¼€â€ã€‚
* **äººè¯**ï¼š**â€œæŸ¥åº“å­˜â€**ã€‚å­å­—ç¬¦ä¸²  é‡ŒåŒ…å«çš„ **æ¯ç§å­—ç¬¦çš„æ•°é‡**ï¼Œå¿…é¡»  `word2` é‡Œè¯¥å­—ç¬¦çš„æ•°é‡ã€‚
* *ä¸éœ€è¦* çœŸçš„æ’åºã€‚
* *ä¸éœ€è¦* çœŸçš„æ¯”è¾ƒå‰ç¼€ã€‚
* åªçœ‹ï¼š**é¢‘æ¬¡ç»Ÿè®¡**ã€‚



### 2. æ ¸å¿ƒéš¾ç‚¹ä¸è§£æ³•

* **éš¾ç‚¹**ï¼š`word1` é•¿åº¦ ï¼Œå¦‚æœæ¯æ¬¡çª—å£æ»‘åŠ¨éƒ½éå† 26 ä¸ªå­—æ¯æ£€æŸ¥æ˜¯å¦è¾¾æ ‡ï¼Œè™½ç„¶å¸¸æ•°å°ï¼Œä½†åœ¨æé™æƒ…å†µä¸‹æ€§èƒ½ä¸ä½³ã€‚
* **è§£æ³•**ï¼š**æ»‘åŠ¨çª—å£ + å·®åˆ†è®¡æ•° (Diff Array)**ã€‚
* **ä¼˜åŒ–æŠ€å·§**ï¼šå¼•å…¥ä¸€ä¸ªå˜é‡ `less`ï¼Œè®°å½• **â€œè¿˜æœ‰å¤šå°‘ç§å­—ç¬¦æ²¡å‡‘é½â€**ã€‚
* `less == 0`ï¼šä»£è¡¨æ‰€æœ‰ç§ç±»çš„å€ºåŠ¡éƒ½è¿˜æ¸…äº† -> **çª—å£åˆæ³•**ã€‚
* è¿™æ ·å°†  çš„æ£€æŸ¥é™ç»´æ‰“å‡»æˆ ã€‚



---

### 3. ä»£ç é€»è¾‘è¯¦è§£ï¼ˆèƒŒè¯µç‰ˆï¼‰

```cpp
class Solution {
public:
    long long validSubstringCount(string s, string t) {
        // è¾¹ç•Œå¤„ç†ï¼šåŸæ–™æ¯”ç›®æ ‡è¿˜çŸ­ï¼Œä¸å¯èƒ½å‡‘é½
        if (s.length() < t.length()) return 0;

        // --- é˜¶æ®µ 1: å»ºç«‹æ¬ å€ºè¡¨ ---
        int diff[26]{}; // è®°å½•æ¯ä¸ªå­—ç¬¦çš„â€œä¾›éœ€å·®â€
        for(char c : t) {
            diff[c - 'a']++; // æ­£æ•°è¡¨ç¤ºï¼šæˆ‘è¿˜ç¼ºå¤šå°‘ä¸ª
        }

        // ç»Ÿè®¡ä¸€å¼€å§‹æœ‰â€œå‡ ç§â€å­—ç¬¦æ˜¯æ¬ å€ºçŠ¶æ€
        int less = 0; 
        for(int d : diff) {
            if(d > 0) less++;
        }

        long long ans = 0;
        int left = 0;

        // --- é˜¶æ®µ 2: æ»‘åŠ¨çª—å£ (Right ä¸»åŠ¨è¿›) ---
        for(char c : s) {
            // 1. è¿›çª—å£æ“ä½œ
            // æ— è®ºæ˜¯ä¸æ˜¯å€ºä¸»ï¼Œå…ˆå‡å»éœ€æ±‚ï¼ˆåº“å­˜å¢åŠ äº†ï¼‰
            diff[c - 'a']--; 
            
            // æ ¸å¿ƒåˆ¤æ–­ï¼šå¦‚æœå‡å®Œä¹‹åå˜æˆäº†0ï¼Œè¯´æ˜åˆšæ‰æ­£å¥½æŠŠè¿™ç¬”å€ºè¿˜æ¸…äº†
            // (æ³¨æ„ï¼šå¦‚æœæ˜¯ä» 0 å‡åˆ° -1ï¼Œé‚£æ˜¯åº“å­˜å¯Œä½™ï¼Œless ä¸å˜)
            if (diff[c - 'a'] == 0) {
                less--;
            }

            // 2. å°è¯•æ”¶ç¼© (å½“ less == 0 æ—¶ï¼Œè¯´æ˜çª—å£å®Œå…¨åˆæ³•)
            while (less == 0) {
                // æ­¤æ—¶çª—å£ [left, right] åˆæ³•
                // æˆ‘ä»¬å°è¯•æŠŠ left è¸¢å‡ºå»ï¼Œçœ‹è¿˜è¡Œä¸è¡Œ
                char out_char = s[left++] - 'a';
                
                // å¦‚æœè¸¢å‡ºå»çš„è¿™ä¸ªå­—ç¬¦ï¼Œç°åœ¨çš„åº“å­˜æ˜¯ 0 (è¯´æ˜ä¹‹å‰æ­£å¥½å¤Ÿç”¨)
                // è¸¢èµ°åå°±ä¼šå˜æˆ 1 (æ¬ å€ºäº†)ï¼Œæ‰€ä»¥ less è¦åŠ å›æ¥
                if (diff[out_char] == 0) {
                    less++;
                }
                
                // æ¢å¤å·®å€¼ (è¸¢å‡ºå»äº†ï¼Œåº“å­˜å˜å°‘ï¼Œéœ€æ±‚å˜å¤§)
                diff[out_char]++;
            }

            // 3. ç´¯åŠ ç­”æ¡ˆ
            // while ç»“æŸæ—¶ï¼Œleft åœåœ¨â€œç¬¬ä¸€ä¸ªå¯¼è‡´çª—å£ä¸åˆæ³•â€çš„ä½ç½®
            // æ„å‘³ç€ [0...right], [1...right] ... [left-1...right] éƒ½æ˜¯åˆæ³•çš„
            // è¿™ä¸€å…±æ˜¯ left ä¸ªèµ·ç‚¹
            ans += left;
        }
        return ans;
    }
};

```

---

### 4. å…³é”®å˜é‡å›¾è§£

å‡è®¾ `word2 (t) = "aab"`ã€‚

#### åˆå§‹çŠ¶æ€

* `diff['a'] = 2` (ç¼º2ä¸ª)
* `diff['b'] = 1` (ç¼º1ä¸ª)
* **`less = 2`** (å› ä¸ºæœ‰ 'a' å’Œ 'b' ä¸¤ç§æ¬ å€º)

#### è¿‡ç¨‹æ¨æ¼”

| åŠ¨ä½œ | å½“å‰å­—ç¬¦ | diff å˜åŒ– | diff['a'] | diff['b'] | less å˜åŒ– | å«ä¹‰ |
| --- | --- | --- | --- | --- | --- | --- |
| **Right è¿›** | 'a' | 2 -> 1 | **1** | 1 | ä¸å˜ (2) | è¿˜äº†1ä¸ªaï¼Œä½†è¿˜æ¬ 1ä¸ªaï¼Œlessæ²¡å˜ |
| **Right è¿›** | 'a' | 1 -> 0 | **0** | 1 | **2 -> 1** | aè¿˜æ¸…äº†ï¼lesså‡1ï¼Œç°åœ¨åªæ¬ bäº† |
| **Right è¿›** | 'b' | 1 -> 0 | 0 | **0** | **1 -> 0** | bä¹Ÿè¿˜æ¸…äº†ï¼lesså˜0 -> **çª—å£åˆæ³•ï¼** |
| **Right è¿›** | 'a' | 0 -> -1 | **-1** | 0 | ä¸å˜ (0) | aå¯Œä½™äº†ï¼Œlessè¿˜æ˜¯0ï¼Œçª—å£ä¾ç„¶åˆæ³• |

#### å‡ºçª—å£ (Left) é€»è¾‘

å‡è®¾ç°åœ¨çŠ¶æ€æ˜¯ `diff['a']=-1`, `diff['b']=0`, `less=0` (åˆæ³•)ã€‚

* **ç§»å‡º 'a'**: `diff['a']` ä» -1 å˜ä¸º 0ã€‚è¿˜æ²¡æ¬ å€ºï¼Œ`less` ä¸å˜ã€‚
* **ç§»å‡º 'b'**: `diff['b']` ä» 0 å˜ä¸º 1ã€‚**æ¬ å€ºäº†ï¼** `less` å˜ä¸º 1 (ä¸åˆæ³•äº†ï¼Œåœæ­¢æ”¶ç¼©)ã€‚

---

### 5. é¿å‘æŒ‡å—

1. **åˆå§‹åŒ–çš„ `less**`ï¼š
* åƒä¸‡ä¸è¦ `less = t.length()`ã€‚
* `less` ç»Ÿè®¡çš„æ˜¯ **â€œç§ç±»æ•°â€**ï¼Œä¸æ˜¯å­—ç¬¦æ€»æ•°ã€‚å¦‚æœ `t="aaa"`, `less` åº”è¯¥æ˜¯ 1ï¼Œä¸æ˜¯ 3ã€‚


2. **diff çš„æ­£è´Ÿå«ä¹‰**ï¼š
* **æ­£æ•°**ï¼šæ¬ å€ºï¼ˆå¿…é¡»è¡¥é½ï¼‰ã€‚
* **0**ï¼šæ”¶æ”¯å¹³è¡¡ï¼ˆåˆšå¥½å¤Ÿï¼‰ã€‚
* **è´Ÿæ•°**ï¼šå¯Œä½™ï¼ˆå¤šäº†ä¹Ÿæ²¡äº‹ï¼‰ã€‚


3. **åˆ¤æ–­æ—¶æœº**ï¼š
* `less--` å‘ç”Ÿåœ¨ `diff` åˆšå¥½å˜æˆ 0 çš„é‚£ä¸€åˆ»ã€‚
* `less++` å‘ç”Ÿåœ¨ `diff` åŸæœ¬æ˜¯ 0 (ç°åœ¨è¦å˜1) çš„é‚£ä¸€åˆ»ã€‚



### 6. æ ¸å¿ƒè®°å¿†å£è¯€

> **æ­£æ•°æ¬ å€ºè´Ÿæ•°å¯Œï¼Œ**
> **å‡åˆ°é›¶æ—¶å€ºè¿˜æ¸… (less--)ã€‚**
> **è¸¢äººè‹¥ä½¿é›¶å˜æ­£ï¼Œ**
> **é‡å›æ¬ å€ºä¸æ¶ˆåœ (less++)ã€‚**
